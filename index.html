<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Universal AI Premium</title>

<script src="https://cdn.tailwindcss.com"></script>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>

</head>

<body class="bg-gray-950 text-gray-100 h-screen flex overflow-hidden">

<!-- LOGIN SCREEN -->
<div id="loginScreen" class="w-full flex items-center justify-center bg-gradient-to-br from-indigo-600 to-purple-600">
  <div class="bg-gray-900 p-8 rounded-xl shadow-2xl text-center w-96">
    <h2 class="text-2xl font-bold mb-6">Universal AI</h2>
    <button onclick="googleLogin()"
      class="bg-white text-black px-6 py-3 rounded-lg w-full font-semibold hover:scale-105 transition">
      Continue with Google
    </button>
  </div>
</div>

<!-- MAIN APP -->
<div id="app" class="hidden w-full flex">

  <!-- SIDEBAR -->
  <div class="w-72 bg-gray-900 border-r border-gray-800 flex flex-col">

    <div class="p-4 flex items-center gap-3 border-b border-gray-800">
      <img id="userPhoto" class="w-8 h-8 rounded-full">
      <span id="userName" class="text-sm"></span>
    </div>

    <button onclick="newChat()" 
      class="m-4 bg-indigo-600 hover:bg-indigo-700 p-2 rounded-lg">
      + New Chat
    </button>

    <div id="chatList" class="flex-1 overflow-y-auto px-3 space-y-2"></div>

    <div class="p-4 border-t border-gray-800">
      <button onclick="logout()" class="text-red-400 hover:underline">Logout</button>
    </div>
  </div>

  <!-- MAIN CHAT -->
  <div class="flex-1 flex flex-col">

    <div class="p-4 border-b border-gray-800 bg-gray-900">
      <select id="modelSelect" class="bg-gray-800 p-2 rounded">
        <option value="gpt-4o-mini">gpt-4o-mini</option>
        <option value="gpt-4">gpt-4</option>
      </select>
    </div>

    <div id="chatBox" class="flex-1 overflow-y-auto p-6 space-y-6"></div>

    <div class="p-4 bg-gray-900 border-t border-gray-800 flex gap-3">
      <input id="userInput" type="text"
        class="flex-1 bg-gray-800 p-3 rounded-lg">
      <button onclick="sendMessage()" 
        class="bg-indigo-600 hover:bg-indigo-700 px-6 rounded-lg">
        Send
      </button>
    </div>

  </div>
</div>

<script>
// ðŸ”¥ PASTE YOUR FIREBASE CONFIG HERE
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_AUTH_DOMAIN",
  projectId: "YOUR_PROJECT_ID",
  appId: "YOUR_APP_ID"
};

// INIT FIREBASE
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const provider = new firebase.auth.GoogleAuthProvider();

let chats = [];
let currentChat = null;
let userId = null;

// GOOGLE LOGIN
function googleLogin(){
  auth.signInWithPopup(provider);
}

auth.onAuthStateChanged(user=>{
  if(user){
    userId = user.uid;
    document.getElementById("loginScreen").classList.add("hidden");
    document.getElementById("app").classList.remove("hidden");

    document.getElementById("userName").innerText = user.displayName;
    document.getElementById("userPhoto").src = user.photoURL;

    loadChats();
  }
});

// LOGOUT
function logout(){
  auth.signOut();
  location.reload();
}

// USER-SPECIFIC STORAGE
function saveChats(){
  localStorage.setItem("chats_"+userId, JSON.stringify(chats));
}

function loadChats(){
  chats = JSON.parse(localStorage.getItem("chats_"+userId)) || [];
  renderChats();
}

// CHAT FUNCTIONS
function newChat(){
  const chat = { id: Date.now(), name: "New Chat", messages: [] };
  chats.push(chat);
  currentChat = chat;
  saveChats();
  renderChats();
  renderMessages();
}

function renderChats(){
  const list = document.getElementById("chatList");
  list.innerHTML = "";
  chats.forEach(chat=>{
    const div = document.createElement("div");
    div.className="p-2 rounded hover:bg-gray-800 cursor-pointer";
    div.innerText=chat.name;
    div.onclick=()=>{ currentChat=chat; renderMessages(); };
    list.appendChild(div);
  });
}

function renderMessages(){
  const box = document.getElementById("chatBox");
  box.innerHTML="";
  if(!currentChat) return;
  currentChat.messages.forEach(msg=>{
    const div=document.createElement("div");
    div.className= msg.role==="user" ? "text-right" : "text-left";
    div.innerHTML=`
      <div class="inline-block px-4 py-3 rounded-2xl max-w-xl
      ${msg.role==="user"?"bg-indigo-600":"bg-gray-800"}">
      ${msg.content}
      </div>`;
    box.appendChild(div);
  });
}

async function sendMessage(){
  const input=document.getElementById("userInput");
  if(!input.value.trim()||!currentChat) return;

  const text=input.value;
  input.value="";
  currentChat.messages.push({role:"user",content:text});
  renderMessages();

  const endpoint=localStorage.getItem("apiEndpoint");
  const key=localStorage.getItem("apiKey");
  const model=document.getElementById("modelSelect").value;

  const res=await fetch(endpoint,{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "Authorization":"Bearer "+key
    },
    body:JSON.stringify({
      model:model,
      messages:currentChat.messages
    })
  });

  const data=await res.json();
  const reply=data.choices?.[0]?.message?.content || "No response";

  currentChat.messages.push({role:"assistant",content:reply});
  saveChats();
  renderMessages();
}
</script>

</body>
</html>

